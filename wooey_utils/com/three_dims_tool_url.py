# -*- coding: UTF-8 -*-

'''
Author: Henry Wang
Date: 2021-11-12 16:47
Short Description:

Change History:




{
    "point":
    {
        "format": "pcd",
        "pcd": {
            "i": "intensity"
        }
    },
    "tag": "2",
    "frames":
    {
        "internalUrls":
        [
            "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/JC20211105/61850507e6c0021c95cc20e7/point_cloud/pcd/1635643800011611.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-1_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-2_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-3_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-4_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-5_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-6_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-7_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-8_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-9_b.pcd"
        ],
        "urls": [
            "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/JC20211105/618505071111e6c0021c95cc20e7/point_cloud/pcd/1635643800011611.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/8_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/7_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/6_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/5_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/4_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/3_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/2_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/1_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0_a.pcd"
        ]
    },
    "groundRemoved":
    {
        "internalUrls":
        [
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0_a.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/1_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/2_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/3_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/4_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/5_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/6_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/7_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/8_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/9_b.pcd"
        ],
        "urls": [
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/9_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/8_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/7_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/6_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/5_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/4_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/3_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/2_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/1_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0_a.pcd"
        ]
    },
    "images":
    [
        {
            "camera": "lf_wide_camera",
            "internalUrls":
            [
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329320420741054.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329327517503422.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329334412939198.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329334597488574.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329341157380030.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329341341929406.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329348254142398.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329348438691774.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329355602563006.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329355820666814.jpg"
            ],
            "urls": [
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329355820666814.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329355602563006.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329348438691774.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329348254142398.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329341341929406.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329341157380030.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329334597488574.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329334412939198.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329327517503422.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329320420741054.jpg"
            ]
        }
    ],
    "options":
    {
        "origins":
        [
            {
                "x": 0,
                "y": 0,
                "z": 0
            }
        ]
    }
}

'''


import json
import os
import oss2
from wooey_utils.com.config import *
from wooey_utils.com.oss_tool import OSS_API
from peutils.textutil import gen_uuid
from concurrent import futures
import pandas as pd

class GEN_ManifestV2():
    def __init__(self,batch,group,total_frames,max_frames,
                 pcd_urls, pcd_internalUrls,
                 image_folders, img_urls, img_internalUrls,
                 client_json_urls,
                 tag=None, cameraInfo=None, origins_list=None, calibration=None,all_range_lst=None):
        self.batch = batch
        self.group = group
        self.oss_json_dir = os.path.join("3d_json/manifest",gen_uuid()) # 每次使用不一样的路径

        self.total_frames = total_frames
        self.max_frames = max_frames

        self.pcd_urls = pcd_urls
        self.pcd_internalUrls = pcd_internalUrls

        self.image_folders = image_folders
        self.img_urls = img_urls
        self.img_internalUrls = img_internalUrls

        self.client_json_urls = client_json_urls

        self.tag = tag if tag else gen_uuid()
        self.cameraInfo = cameraInfo if cameraInfo else {}
        self.origins_list = origins_list if origins_list else [{"x": 0, "y": 0, "z": 0}]
        self.calibration = calibration
        self.all_range_lst = all_range_lst

        # self.bucket = oss2.Bucket(oss2.Auth(OSS_AK, OSS_SK), 'https://oss-cn-shanghai.aliyuncs.com', 'projecteng')
        self.oss_obj = OSS_API(bucket_name="projecteng")



    def save_oss_data_by_path(self,oss_full_path, bytes_data):
        rs = self.oss_obj.bucket.put_object(oss_full_path, bytes_data)
        assert rs.status == 200, "文件上传失败"


    @staticmethod
    def template_manifest_json(tag,frames,images,cameraInfo,origins_list,client_json_lst,calibration=None,part_range_lst=None):
        manifest_template = {
            "point": {
                "format": "pcd",
                "pcd": {
                    "i": "intensity"
                }
            },
            "tag": tag,  # 固定,一般情况下没有用。 但是有一个情况，比如数据改了 但是浏览器还缓存着上次的数据  可以修改下这个 tag 强制刷新下浏览器的缓存
            "frames": frames,
            "groundRemoved": frames,
            "images": images,
            "cameraInfo": cameraInfo,
            "options": {
                "origins": origins_list
            },
            "client_json_urls":client_json_lst
        }
        if calibration is not None:
            manifest_template["calibration"] = calibration
        if part_range_lst is not None:
            manifest_template["options"]["range"] = part_range_lst

        return manifest_template

    def get_manifest_json_task(self) :### 返回存储的路径和信息
        # tasks = []
        # json_url_list= []
        if self.max_frames is None:
            self.max_frames = self.total_frames

        for i in range(0, self.total_frames, self.max_frames):
            start = i
            end = min(i + self.max_frames, self.total_frames)
            dirname = f"{self.group}_{start + 1}_{end}"
            json_path = os.path.join(self.oss_json_dir,dirname,"manifest.json")
            ## 不需要manifest.json
            json_url = f'https://projecteng.oss-cn-shanghai.aliyuncs.com/{os.path.dirname(json_path)}'


            ### 计算需要传递的calibration
            if self.calibration is None:
                calibration = None
            else:

                # image_lst = [{
                #     {
                #         "folder": "fake_folder"
                #         "data": "fake.json"
                #     }
                # }]
                calib_file_lst = []
                for i in range(start,end):
                    frame_items = []
                    for camera in  self.image_folders:
                        frame_items.append(self.calibration[camera][i])
                    calib_file_lst.append(frame_items)

                clib_json_name = os.path.join("/projecteng/",self.oss_json_dir,dirname,"calib.json")
                os.makedirs(os.path.dirname(clib_json_name),exist_ok=True)
                with open(clib_json_name,'w',encoding='utf-8') as cf:
                    json.dump(calib_file_lst,cf)


                calibration = {
                    "model": "pinhole",
                    "file":"calib.json",
                    "images":[
                        {
                            "folder":camera,
                            "data": "fake.json"
                        }
                        for camera in self.image_folders
                    ],
                }
            ### 计算需要传递的calibration end

            manifest_template = self.template_manifest_json(
                tag = self.tag,
                frames = {
                    "urls": self.pcd_urls[start:end],
                    "internalUrls": self.pcd_internalUrls[start:end],
                },
                images = [
                    {
                        "camera":camera,
                        "urls": self.img_urls[camera][start:end],
                        "internalUrls": self.img_internalUrls[camera][start:end],
                    } for camera in self.image_folders
                ],
                cameraInfo = self.cameraInfo,
                origins_list = self.origins_list,
                client_json_lst =self.client_json_urls[start:end],
                calibration = calibration,
                part_range_lst = None if self.all_range_lst is None else self.all_range_lst[start:end]
            )
            # print(json_path)

            self.save_oss_data_by_path(json_path,json.dumps(manifest_template,ensure_ascii=False,indent=4).encode('utf-8'))
            # tasks.append([
            #     json_path,
            #     json.dumps(manifest_template,ensure_ascii=False,indent=4).encode('utf-8')
            # ])
            yield json_url
            # json_url_list.append(json_url)

        # return tasks,json_url_list





    def gen_manifest_main(self):
        json_url_list = []
        for url in self.get_manifest_json_task():
            json_url_list.append(url)

        # tasks,json_url_list = self.get_manifest_json_task()



        # with futures.ThreadPoolExecutor(min(16, len(tasks))) as executor:
        #     tasks = [executor.submit(self.json_url_list, info[0],info[1]) for info in tasks]
        #     for future in futures.as_completed(tasks):
        #         url = future.result()

        rs_df = pd.DataFrame(columns=["base_url","upload_batch","upload_group"])
        rs_df["base_url"] = json_url_list
        rs_df["upload_batch"] = self.batch
        rs_df["upload_group"] = self.group
        print("总行数",len(rs_df))
        rs_df.to_csv(gen_uuid()+'.csv',encoding='utf-8-sig',index=False)
        # print(len(rs_df))
        # return rs_df




if __name__ =="__main__":
    m_gen = GEN_ManifestV2(
        batch="20211115",
        group="test",
        total_frames=10,
        max_frames =3,
        pcd_urls=[
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/9_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/8_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/7_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/6_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/5_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/4_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/3_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/2_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/1_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0_a.pcd"
        ],
        pcd_internalUrls=[
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-0_a.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-1_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-2_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-3_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-4_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-5_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-6_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-7_b.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-8_bc.pcd",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/0-9_b.pcd"
        ],
        image_folders=["lf_wide_camera"],
        img_urls={
            "lf_wide_camera":[
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329355820666814.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329355602563006.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329348438691774.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329348254142398.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329341341929406.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329341157380030.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329334597488574.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329334412939198.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329327517503422.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/12329320420741054.jpg"
            ]
        },
        img_internalUrls={
            "lf_wide_camera":[
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329320420741054.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329327517503422.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329334412939198.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329334597488574.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329341157380030.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329341341929406.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329348254142398.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329348438691774.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329355602563006.jpg",
                "https://projecteng.oss-cn-shanghai.aliyuncs.com/haomo_3d/segmentation/LH20210908/61382bc506d035e7d3228ae0/image/lf_wide_camera/0-12329355820666814.jpg"
            ],
        },
        client_json_urls=[
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j1.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j2.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j3.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j4.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j5.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j6.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j7.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j8.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j9.json",
            "https://oss-dev.appen.com.cn:9000/appen-lidar/qichao-test-data/pcd-data/lidar/j10.json"
        ]

    )

    m_gen.gen_manifest_main()